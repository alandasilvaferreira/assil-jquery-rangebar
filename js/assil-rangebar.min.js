function getRect(n){var t=$(n).offset();return{x:t.left,y:t.top,w:$(n).width(),h:$(n).height()}}(function(n){function f(i,r){i.each(function(){var u=i.data("rangebar"),f=u.max-u.min;n.each(r,function(r,u){var e=n("<div class='range'>").data("range",u),y=e.append("<div class='range-label'>"),a;if(i.append(e),a=v(f,i.width(),u),e.offset({left:a.left,top:i.offset().top}),e.width(a.right-a.left),t({target:e}),!u.disabled){e.resizable({containment:i,handles:"e, w",resize:o});e.draggable({containment:i,scroll:!1,axis:"x",handle:".range-label",start:s,drag:h,stop:c});e.on("click",l)}})})}function e(t,i){if(!i)return null;var r;i.start!=null||i.end!=null||(r=n(i));r.remove()}function i(t,i){var u=n(t.target),o=n(t.target).parent(),f=getRect(o),e=getRect(u),r;return i.position.top=i.originalPosition.top,i.offset&&(i.offset.top=i.originalPosition.top),i.size&&(i.position.left+i.size.width>f.w&&(i.size.width=f.w-i.position.left),i.position.left=i.position.left<0?0:i.position.left),r=u.overlapsX(u.siblings()),r.length>0?(n.each(r,function(){var t=this,n=getRect(t.obstacle);if(i.size)return t.overlap.isOverlapLeft?i.position.left=n.x+n.w:t.overlap.isOverlapRight&&(i.size.width=n.x-e.x),!0;t.overlap.isOverlapLeft?i.position.left=n.x+n.w:t.overlap.isOverlapRight&&(i.position.left=n.x-e.w)}),i.offset=i.position,console.log(JSON.stringify(r)),!0):void 0}function o(n,r){i(n,r);t(n,r)}function s(n,r){i(n,r);t(n,r)}function h(n,r){i(n,r);t(n,r)}function c(n,r){i(n,r);t(n,r)}function l(t){t.stopPropagation();t.preventDefault();var i=n(this),r=i.parent(),u=r.data("rangebar");t.which===2&&u.allowDelete&&(i.data("deleteConfirm")?(e(r,this),clearTimeout(i.data("deleteTimeout"))):(i.addClass("delete-confirm"),i.data("deleteConfirm",!0),this.deleteTimeout=setTimeout(function(){i.removeClass("delete-confirm");i.data("deleteConfirm",!1)},u.deleteTimeout)))}function a(t){var i=n(t.target);console.log(JSON.stringify({cx:t.clientX,xy:t.clientY}))}function t(t){var i=n(t.target),f=i.parent(),e=f.data("rangebar"),o=e.max-e.min,s=f.width(),h=i.offset().left,c={start:u(o,r(s,h)),end:u(o,r(s,h+i.width()))};i.height(f.height());i.data("range",c);n(".range-label",i).text(e.label(c))}function v(n,t,i){return{left:u(t,r(n,i.start)),right:u(t,r(n,i.end))}}function r(n,t){return t*100/n}function u(n,t){return n*t/100}n.fn.rangeBar=function(t){var i=n.extend({},n.fn.rangeBar.defaultOptions,t);return this.each(function(){var t=n(this);t.data("rangebar",i);t.on("mousemove",a);f(t,i.ranges)})};n.fn.rangeBar.defaultOptions={min:0,max:100,ranges:[],label:function(n){return parseInt(n.start)+"-"+parseInt(n.end)},allowDelete:!0,deleteTimeout:5e3};n.fn.rangeBar.defaultRange={start:0,end:0,disabled:!1,css:"",canOverlap:!1}})(jQuery),function(n){function t(n,t){var i={isOverlapRight:n.x+n.w>t.x&&n.x<t.x,isOverlapLeft:n.x<t.x+t.w&&n.x>t.x,isOverlapBottom:n.y+n.h>t.y&&n.y<t.y,isOverlapTop:n.y<t.y+t.h&&n.y>t.y};return i.isOverlaped=i.isOverlapLeft||i.isOverlapRight||i.isOverlapTop||i.isOverlapBottom,i}function i(n,t){var i={isOverlapRight:n.x+n.w>t.x&&n.x<t.x,isOverlapLeft:n.x<t.x+t.w&&n.x>t.x};return i.isOverlaped=i.isOverlapLeft||i.isOverlapRight,i}function r(n,t){var i={isOverlapBottom:n.y+n.h>t.y&&n.y<t.y,isOverlapTop:n.y<t.y+t.h&&n.y>t.y};return i.isOverlaped=i.isOverlapTop||i.isOverlapBottom,i}n.fn.pointOverlaps=function(i){var r=[],u=func_isOverlapRect||t;this.each(function(){var t=this,e=n(t),f=getRect(this);n.each(i,function(){var n=this,e=getRect(n),i=u(f,e);i.isOverlaped&&r.push({src:t,obstacle:n,overlap:i})})})};n.fn.overlaps=function(i,r){var u=[],f=r||t;return this.each(function(){var t=this,e=n(t),r=getRect(this);n(i).each(function(){var i=this,o=n(i),s=getRect(o),e=f(r,s);e.isOverlaped&&u.push({src:t,obstacle:i,overlap:e})})}),u};n.fn.overlapsX=function(n){return this.overlaps(n,i)};n.fn.overlapsY=function(n){return this.overlaps(n,r)}}(jQuery);